<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Order Details - {{ full_name }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #0f172a; color: #e0f7fa; }

    .btn-neon {
      background-color: #00e0ff;
      color: white;
      border: none;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px #00e0ff, 0 0 20px #00e0ff;
    }

    .btn-neon:hover {
      background-color: #00bcd4;
      box-shadow: 0 0 20px #00bcd4, 0 0 30px #00bcd4;
    }

    .card-section {
      background-color: #0f1a2b;
      border-left: 4px solid #00e0ff;
      padding: 1.5rem;
      border-radius: 0.75rem;
      box-shadow: 0 0 10px rgba(0, 224, 255, 0.2);
    }

    .clickable-card:hover {
      cursor: pointer;
      background-color: #11233a;
      transition: background-color 0.3s;
    }
  </style>
</head>

<body class="min-h-screen bg-[#0f172a] text-cyan-100 px-4 sm:px-6 py-10">
  <div class="max-w-4xl mx-auto space-y-6">

    <!-- Header with Back and Help -->
    <div class="flex justify-between items-center mb-2">
      <div class="flex items-center space-x-3">
        <a href="{{ url_for('my_orders') }}" class="text-cyan-400 hover:text-cyan-200 text-xl">←</a>
        <h1 class="text-3xl font-bold text-cyan-400">Order Details</h1>
      </div>
      <div>
        <a href="https://wa.me/918120709649?text=Hi%20I%20need%20help%20regarding%20order%20#{{ order.id }}" target="_blank"
           class="text-sm font-semibold text-cyan-300 hover:text-cyan-100">
          Help
        </a>
      </div>
    </div>

    <!-- products Card (Clickable) -->
    <a href="{{ url_for('cart', products_id=order.products_id) }}">
      <div class="card-section clickable-card">
        <h2 class="text-xl font-semibold text-cyan-300 mb-4">products Info</h2>
        <div class="flex flex-col sm:flex-row items-center gap-4">
          <img src="{{ url_for('static', filename='uploads/products/' + order.image) }}" alt="products Image"
               class="h-32 w-32 object-contain rounded-lg">
          <div class="text-center sm:text-left">
            <p class="text-lg font-semibold">{{ order.item_name }}</p>
            <p class="text-cyan-300">Price: ₹{{ order.amount }}</p>
            <p class="text-cyan-400 text-sm">Qty: {{ order.quantity }}</p>
          </div>
        </div>
      </div>
    </a>

    <!-- Status & Date Card -->
    <div class="card-section">
      <h2 class="text-xl font-semibold text-cyan-300 mb-2">Order Status</h2>
      <p class="text-cyan-200">
        Status: <span class="font-bold capitalize">{{ order.status }}</span>
      </p>
      <p class="text-cyan-400 text-sm mt-1">
        {% if order.status == 'pending' and order.created_at %}
  Placed on: {{ order.created_at.strftime('%d %b %Y, %I:%M %p') }}
{% elif order.status == 'accepted' and order.accepted_at %}
  Accepted on: {{ order.accepted_at.strftime('%d %b %Y, %I:%M %p') }}
{% elif order.status == 'cancelled' and order.cancelled_at %}
  Cancelled on: {{ order.cancelled_at.strftime('%d %b %Y, %I:%M %p') }}
{% elif order.status == 'delivered' and order.delivered_at %}
  Delivered on: {{ order.delivered_at.strftime('%d %b %Y, %I:%M %p') }}
{% else %}
  Date not available.
{% endif %}
      </p>
    </div>

    <!-- Delivery Address -->
    <div class="card-section">
      <h2 class="text-xl font-semibold text-cyan-300 mb-4">Delivery Address</h2>
      <p><span class="text-cyan-400 font-semibold">Name:</span> {{ full_name }}</p>
      <p><span class="text-cyan-400 font-semibold">Address:</span> {{ order.address1 }}, {{ order.address2 }}</p>
      <p><span class="text-cyan-400 font-semibold">City:</span> {{ order.city }}</p>
      <p><span class="text-cyan-400 font-semibold">Pincode:</span> {{ order.pincode }}</p>
    </div>

    <!-- Total -->
    <div class="card-section text-center">
      <h2 class="text-xl font-semibold text-cyan-300 mb-2">Total Price</h2>
      <div class="text-3xl font-bold text-green-400">₹{{ order.amount * order.quantity }}</div>
      <p class="text-sm text-cyan-400 mt-1">({{ order.quantity }} × ₹{{ order.amount }} per item)</p>
    </div>

    <!-- Cancel Button -->
    {% if order.status == 'pending' %}
    <div class="text-center">
      <form action="{{ url_for('cancel_order', order_id=order.id) }}" method="POST"
            onsubmit="return confirm('Are you sure you want to cancel this order?');">
        <button type="submit" class="btn-neon text-sm px-4 py-2 rounded">
          Cancel Order
        </button>
      </form>
    </div>
    {% endif %}

  </div>
</body>
</html>
